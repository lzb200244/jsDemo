<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div class="app">
    <input id="phone" type="tel" placeholder="请输入手机号码">
    <button onclick="sendCode()" id="code">获取验证码</button>
</div>
</body>
<script>
    const phone = document.getElementById("phone")
    const code = document.getElementById("code")
    const valid = JSON.parse(localStorage.getItem("valid"))
    let count = 60
    let timer = null
    //小于60说明在有效时间内
    if (valid) {
        let expired = Math.ceil((new Date().getTime() - valid.now) / 1000)
        if (0 < expired && expired < 60) {
            //时间变为剩下的时间
            phone.value = valid.phone
            count -= expired
            //手动执行
            sendCode()
        } else {
            localStorage.removeItem("valid")
        }
    }

    function sendCode() {
        //刷新验证码依旧有效
        timer = setInterval(function () {
            //非刷新
            if (!valid) {
                const valid = {phone: phone.value, now: new Date().getTime()}
                localStorage.setItem("valid", JSON.stringify(valid))
            }
            code.innerText = String(--count)
            code.setAttribute('disabled', 'disabled')
            if (count === 0) {
                code.innerText = "重新获取验证码"
                code.removeAttribute('disabled')
                //count复原
                count = 60
                //清除定时器
                localStorage.removeItem("valid")
                clearInterval(timer)
            }
        }, 1000)
    }
</script>
</html>